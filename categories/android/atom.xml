<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Android | Programming Notes]]></title>
  <link href="http://java.paykin.info/categories/android/atom.xml" rel="self"/>
  <link href="http://java.paykin.info/"/>
  <updated>2013-09-27T14:19:42+03:00</updated>
  <id>http://java.paykin.info/</id>
  <author>
    <name><![CDATA[Dmitry Paykin]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Android browser recognizes CSS media type after page reloading]]></title>
    <link href="http://java.paykin.info/android-css-media-reloading/"/>
    <updated>2011-10-20T00:00:00+02:00</updated>
    <id>http://java.paykin.info/android-css-media-reloading</id>
    <content type="html"><![CDATA[<p>While trying to optimize site for mobile devices you have to add viewport meta tag:
``` html
&lt;meta name=&ldquo;viewport&rdquo;</p>

<pre><code>content="target-densitydpi=device-dpi, width=device-width, height=device-height, initial-scale=1.0" /&gt;
</code></pre>

<p>```
You can add additional CSS file that will be used on mobile device only. To achieve this just add CSS media type. In Android developer&rsquo;s guide at <a href="http://developer.android.com/guide/webapps/targeting.html"><a href="http://developer.android.com/guide/webapps/targeting.html">http://developer.android.com/guide/webapps/targeting.html</a></a> it suggests to target device DPI value like:</p>

<!--more-->


<p>``` html
&lt;link rel=&ldquo;stylesheet&rdquo; href=&ldquo;css/mobile.css&rdquo; type=&ldquo;text/css&rdquo;</p>

<pre><code>media="screen and (-webkit-device-pixel-ratio:1.0)" /&gt;
</code></pre>

<p>```
It works fine, but Google Chrome on desktop PC also loads this CSS file.</p>

<p>There is another solution to target mobile devices (both Android, iPhone, Blackberry): to specify maximal width of the screen like:
``` html
&lt;link rel=&ldquo;stylesheet&rdquo; href=&ldquo;css/mobile.css&rdquo; type=&ldquo;text/css&rdquo;</p>

<pre><code>media="screen and (max-device-width:801px) and (max-width:801px)" /&gt;
</code></pre>

<p>```
The problem is that Android (at least 2.3 I&rsquo;ve tested) recognizes this media type only after page reloading (refreshing) in browser. Googling the web I found the open <a title="issue" href="http://code.google.com/p/android/issues/detail?id=11961" target="_blank">issue</a>.</p>

<p>I solved it using JavaScript:
``` javascript
if(isMobile){</p>

<pre><code>var cssLink = document.createElement("link");
cssLink.setAttribute("type", "text/css");
cssLink.setAttribute("rel", "stylesheet");
cssLink.setAttribute("href", "css/mobile.css");
document.head.appendChild(cssLink);
</code></pre>

<p>}
```
I tested it on my device an it works fine, unless some little delay: the CSS file loads only after JavaScript executes. When google will fix the issue (I hope so&hellip;), there will be no delay, since original link is in the HEAD section.</p>

<p>Of course you have to detect mobile device using the JavaScript, I used solution suggested here: <a href="http://localstreamer.posterous.com/javascript-code-snippet-how-to-detect-all-mob"><a href="http://localstreamer.posterous.com/javascript-code-snippet-how-to-detect-all-mob">http://localstreamer.posterous.com/javascript-code-snippet-how-to-detect-all-mob</a></a></p>
]]></content>
  </entry>
  
</feed>
